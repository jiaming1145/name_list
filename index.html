<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Attendance Form</title>
    <style>
        body {
            font-family: Arial, sans-serif;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        th {
            background-color: #f2f2f2;
        }
        .checkbox-cell {
            text-align: center;
        }
    </style>
</head>
<body>
    <h1>Attendance Form</h1>
    <table>
        <thead>
            <tr>
                <th>Present</th>
                <th>Class</th>
                <th>Name</th>
                <th>Number</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td class="checkbox-cell"><input type="checkbox" name="attendance"></td>
                <td>7-196</td>
                <td>Yichen</td>
                <td>10</td>
            </tr>
            <tr>
                <td class="checkbox-cell"><input type="checkbox" name="attendance"></td>
                <td>7-196</td>
                <td>Kevin</td>
                <td>8</td>
            </tr>
            <tr>
                <td class="checkbox-cell"><input type="checkbox" name="attendance"></td>
                <td>4-301</td>
                <td>Hannah</td>
                <td>10</td>
            </tr>
            <tr>
                <td class="checkbox-cell"><input type="checkbox" name="attendance"></td>
                <td>7-348</td>
                <td>Henry</td>
                <td>8</td>
            </tr>
            <tr>
                <td class="checkbox-cell"><input type="checkbox" name="attendance"></td>
                <td>7-348</td>
                <td>Luna</td>
                <td>6</td>
            </tr>
            <tr>
                <td class="checkbox-cell"><input type="checkbox" name="attendance"></td>
                <td>4-383</td>
                <td>Joshua</td>
                <td>7</td>
            </tr>
            <tr>
                <td class="checkbox-cell"><input type="checkbox" name="attendance"></td>
                <td>2-299</td>
                <td>Winchell</td>
                <td>9</td>
            </tr>
            <tr>
                <td class="checkbox-cell"><input type="checkbox" name="attendance"></td>
                <td>7-384</td>
                <td>Morgan</td>
                <td>8</td>
            </tr>
            <tr>
                <td class="checkbox-cell"><input type="checkbox" name="attendance"></td>
                <td>1-20</td>
                <td>Kaitlyn</td>
                <td>8</td>
            </tr>
            <tr>
                <td class="checkbox-cell"><input type="checkbox" name="attendance"></td>
                <td>4-408</td>
                <td>Zeen</td>
                <td>13</td>
            </tr>
            <tr>
                <td class="checkbox-cell"><input type="checkbox" name="attendance"></td>
                <td>4-149</td>
                <td>Shiqi</td>
                <td>11</td>
            </tr>
            <tr>
                <td class="checkbox-cell"><input type="checkbox" name="attendance"></td>
                <td>4-149</td>
                <td>Shiwei</td>
                <td>11</td>
            </tr>
            <tr>
                <td class="checkbox-cell"><input type="checkbox" name="attendance"></td>
                <td>7-95</td>
                <td>Cindy</td>
                <td>8</td>
            </tr>
            <tr>
                <td class="checkbox-cell"><input type="checkbox" name="attendance"></td>
                <td>8-216</td>
                <td>Nora</td>
                <td>8</td>
            </tr>
            <tr>
                <td class="checkbox-cell"><input type="checkbox" name="attendance"></td>
                <td>8-162</td>
                <td>Sally</td>
                <td>8</td>
            </tr>
            <tr>
                <td class="checkbox-cell"><input type="checkbox" name="attendance"></td>
                <td>8-237</td>
                <td>Ethan</td>
                <td>11</td>
            </tr>
            <tr>
                <td class="checkbox-cell"><input type="checkbox" name="attendance"></td>
                <td>8-238</td>
                <td>Mason</td>
                <td>12</td>
            </tr>
            <tr>
                <td class="checkbox-cell"><input type="checkbox" name="attendance"></td>
                <td>7-326</td>
                <td>Regina</td>
                <td>9</td>
            </tr>
            <tr>
                <td class="checkbox-cell"><input type="checkbox" name="attendance"></td>
                <td>7-326</td>
                <td>Angel</td>
                <td>9</td>
            </tr>
        </tbody>
    </table>
    <div class="button-container">
        <button onclick="copyTable()">Create Copy</button>
    </div>
    <div class="button-container">
        <button onclick="sendSummary()">Send Attendance Summary</button>
    </div>

    <!-- Include EmailJS SDK -->
    <script type="text/javascript" src="https://cdn.emailjs.com/dist/email.min.js"></script>

    <script>
        (function() {
            emailjs.init("your_user_id"); // Replace with your EmailJS user ID
        })();

        function sendSummary() {
            // Get all the rows from the table
            const rows = document.querySelectorAll("#attendance-table tbody tr");
            let absentList = [];
            let presentCount = 0;

            rows.forEach(row => {
                const checkbox = row.querySelector('input[type="checkbox"]');
                const name = row.cells[2].textContent; // Get the name from the table row

                if (checkbox.checked) {
                    presentCount++;
                } else {
                    absentList.push(name); // Add absent person's name to the list
                }
            });

            // Create the email message content
            const message = `
                <p>Summary of Attendance:</p>
                <p>Total Present: ${presentCount}</p>
                <p>Absent: ${absentList.join(", ")}</p>
            `;

            // Send the email using EmailJS
            emailjs.send("service_oqynfkb", "namelist", {
                from_name: "Attendance System", // Change this to your name or something relevant
                to_email: "jiamingqian420@gmail.com", // Replace with the recipient's email address
                message: message
            })
            .then(function(response) {
                alert("Attendance summary sent successfully!");
            }, function(error) {
                alert("Failed to send email. Please try again.");
            });
        }
    </script>
</body>
</html>
